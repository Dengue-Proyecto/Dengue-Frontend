<!-- Solo mostrar si hay sesiÃ³n iniciada -->
<ng-container *ngIf="estaLogueado">

<!-- BotÃ³n flotante para abrir feedback -->
<button class="feedback-trigger" (click)="abrirModal()" title="Danos tu opiniÃ³n">
  <span class="feedback-icon">ðŸ’¬</span>
</button>

<!-- Modal de Feedback -->
<div class="feedback-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
  <div class="feedback-modal" (click)="$event.stopPropagation()">

    <!-- Header -->
    <div class="feedback-header">
      <h3>Tu opiniÃ³n nos importa</h3>
      <button class="close-btn" (click)="cerrarModal()">âœ•</button>
    </div>

    <!-- Contenido -->
    <div class="feedback-content" *ngIf="!enviado">
      <p class="feedback-subtitle">AyÃºdanos a mejorar el rendimiento de la aplicaciÃ³n</p>

      <!-- Pregunta 1: Velocidad de carga -->
      <div class="feedback-question">
        <label>Â¿La aplicaciÃ³n carga rÃ¡pido en tu dispositivo?</label>
        <div class="rating-stars">
          <button *ngFor="let star of [1,2,3,4,5]"
                  class="star-btn"
                  [class.active]="feedback.velocidad >= star"
                  (click)="seleccionarPuntuacion('velocidad', star)">
            {{ feedback.velocidad >= star ? 'â˜…' : 'â˜†' }}
          </button>
        </div>
        <div class="rating-labels">
          <span>Muy lento</span>
          <span>Muy rÃ¡pido</span>
        </div>
      </div>

      <!-- Pregunta 2: Consumo de baterÃ­a -->
      <div class="feedback-question">
        <label>Â¿Has notado consumo alto de baterÃ­a al usar la app?</label>
        <div class="rating-stars">
          <button *ngFor="let star of [1,2,3,4,5]"
                  class="star-btn"
                  [class.active]="feedback.facilidad >= star"
                  (click)="seleccionarPuntuacion('facilidad', star)">
            {{ feedback.facilidad >= star ? 'â˜…' : 'â˜†' }}
          </button>
        </div>
        <div class="rating-labels">
          <span>Consume mucho</span>
          <span>Consume poco</span>
        </div>
      </div>

      <!-- Pregunta 3: Rendimiento general -->
      <div class="feedback-question">
        <label>Â¿Consideras que el rendimiento general es adecuado?</label>
        <div class="rating-stars">
          <button *ngFor="let star of [1,2,3,4,5]"
                  class="star-btn"
                  [class.active]="feedback.eficiencia >= star"
                  (click)="seleccionarPuntuacion('eficiencia', star)">
            {{ feedback.eficiencia >= star ? 'â˜…' : 'â˜†' }}
          </button>
        </div>
        <div class="rating-labels">
          <span>Muy malo</span>
          <span>Excelente</span>
        </div>
      </div>

      <!-- Comentario opcional -->
      <div class="feedback-question">
        <label>Comentarios adicionales (opcional)</label>
        <textarea
          [(ngModel)]="feedback.comentario"
          placeholder="Escribe aquÃ­ tus sugerencias..."
          rows="2"
          maxlength="200">
        </textarea>
      </div>

      <!-- BotÃ³n enviar -->
      <button
        class="submit-btn"
        [disabled]="!formularioValido || enviando"
        (click)="enviarFeedback()">
        {{ enviando ? 'Enviando...' : 'Enviar opiniÃ³n' }}
      </button>
    </div>

    <!-- Mensaje de Ã©xito -->
    <div class="feedback-success" *ngIf="enviado">
      <div class="success-icon">âœ“</div>
      <h4>Gracias por tu opiniÃ³n</h4>
      <p>Tu feedback nos ayuda a mejorar la eficiencia de la aplicaciÃ³n.</p>
    </div>

  </div>
</div>

</ng-container>
